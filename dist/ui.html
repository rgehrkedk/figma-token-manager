<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Design Token Export</title></head><body><h2>Design Token Export</h2><p>Extract your Figma design variables as DTCG-compliant design tokens.</p><div id="content"><div class="option-group"><h3>Format Options</h3><div class="radio-item"><input type="radio" id="format-dtcg" name="format" value="dtcg" checked="checked"> <label for="format-dtcg">DTCG Format (Design Tokens Community Group)</label></div><div class="radio-item"><input type="radio" id="format-legacy" name="format" value="legacy"> <label for="format-legacy">Legacy Format (Simple JSON)</label></div><h3>Export Options</h3><div class="checkbox-item"><input type="checkbox" id="separate-files" checked="checked"> <label for="separate-files">Export separate files (one per collection/mode)</label></div><div class="checkbox-item"><input type="checkbox" id="validate-references" checked="checked"> <label for="validate-references">Validate and fix references</label></div><div class="checkbox-item"><input type="checkbox" id="flat-structure"> <label for="flat-structure">Generate flat structure (easier reference resolution)</label></div></div><div class="selection-group"><h3>Collections <span class="select-all" id="toggle-all-collections">Select All</span></h3><div id="collection-list"><div class="loading"><div class="spinner"></div>Loading collections...</div></div></div><div class="selection-group"><h3>Modes <span class="select-all" id="toggle-all-modes">Select All</span></h3><div id="mode-list"><div class="loading"><div class="spinner"></div>Loading modes...</div></div></div><div id="reference-validation-results" class="reference-validation" style="display: none;"><h3>Reference Validation</h3><div id="validation-content">Validating references...</div></div><div id="preview-container"><h3>Preview</h3><pre id="output">Loading data...</pre></div><div><button id="extract-btn">Refresh Tokens</button> <button id="download-btn" disabled="disabled">Download JSON</button> <button id="validate-btn">Validate References</button></div></div><div id="status" class="info">Waiting for data...</div><script>(()=>{"use strict";var e={56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var l={},c=[],s=0;s<e.length;s++){var i=e[s],a=o.base?i[0]+o.base:i[0],d=l[a]||0,p="".concat(a," ").concat(d);l[a]=d+1;var u=t(p),f={css:i[1],media:i[2],sourceMap:i[3],supports:i[4],layer:i[5]};if(-1!==u)n[u].references++,n[u].updater(f);else{var g=r(f,o);o.byIndex=s,n.splice(s,0,{identifier:p,updater:g,references:1})}c.push(p)}return c}function r(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,r){var l=o(e=e||[],r=r||{});return function(e){e=e||[];for(var c=0;c<l.length;c++){var s=t(l[c]);n[s].references--}for(var i=o(e,r),a=0;a<l.length;a++){var d=t(l[a]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}l=i}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",o=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),o&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),o&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,o,r,l){"string"==typeof e&&(e=[[null,e,void 0]]);var c={};if(o)for(var s=0;s<this.length;s++){var i=this[s][0];null!=i&&(c[i]=!0)}for(var a=0;a<e.length;a++){var d=[].concat(e[a]);o&&c[d[0]]||(void 0!==l&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=l),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),n.push(d))}},n}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601:e=>{e.exports=function(e){return e[1]}},628:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(601),r=t.n(o),l=t(314),c=t.n(l)()(r());c.push([e.id,"body {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    margin: 0;\n    padding: 20px;\n    font-size: 12px;\n    color: #333;\n  }\n  \n  h2 {\n    margin-bottom: 16px;\n    font-size: 16px;\n    font-weight: 600;\n  }\n  \n  h3 {\n    margin-top: 16px;\n    margin-bottom: 8px;\n    font-size: 14px;\n    font-weight: 500;\n  }\n  \n  p {\n    margin-bottom: 16px;\n    color: #666;\n  }\n  \n  button {\n    background-color: #18a0fb;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    padding: 8px 16px;\n    margin-right: 8px;\n    margin-top: 16px;\n    cursor: pointer;\n    font-weight: 500;\n  }\n  \n  button:hover {\n    background-color: #0d8ce0;\n  }\n  \n  button:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n  }\n  \n  .selection-group {\n    margin-top: 16px;\n    margin-bottom: 16px;\n    padding: 12px;\n    border: 1px solid #e5e5e5;\n    border-radius: 4px;\n    background-color: #f9f9f9;\n  }\n  \n  .option-group {\n    margin-top: 16px;\n    margin-bottom: 16px;\n    padding: 12px;\n    border: 1px solid #e5e5e5;\n    border-radius: 4px;\n    background-color: #f0f7ff;\n  }\n  \n  .checkbox-item {\n    display: flex;\n    align-items: center;\n    margin-bottom: 8px;\n  }\n  \n  .checkbox-item label {\n    margin-left: 8px;\n    cursor: pointer;\n  }\n  \n  .radio-item {\n    display: flex;\n    align-items: center;\n    margin-bottom: 8px;\n  }\n  \n  .radio-item label {\n    margin-left: 8px;\n    cursor: pointer;\n  }\n  \n  .mode-container {\n    margin-left: 24px;\n    padding-top: 4px;\n  }\n  \n  pre {\n    background-color: #f5f5f5;\n    padding: 10px;\n    border-radius: 4px;\n    overflow: auto;\n    max-height: 300px;\n    font-family: monospace;\n    font-size: 11px;\n  }\n  \n  .reference-validation {\n    background-color: #fff8e1;\n    padding: 10px;\n    border-radius: 4px;\n    border-left: 4px solid #ffca28;\n    margin-top: 16px;\n    font-size: 11px;\n  }\n  \n  .reference-problem {\n    color: #d32f2f;\n    font-weight: 500;\n    padding: 4px 0;\n  }\n  \n  #status {\n    margin-top: 16px;\n    padding: 8px 12px;\n    border-radius: 4px;\n    font-size: 12px;\n  }\n  \n  .info {\n    background-color: #e8f4fd;\n    color: #0366d6;\n  }\n  \n  .success {\n    background-color: #e6ffed;\n    color: #22863a;\n  }\n  \n  .warning {\n    background-color: #fff8e1;\n    color: #b08800;\n  }\n  \n  .error {\n    background-color: #ffeef0;\n    color: #d73a49;\n  }\n  \n  .loading {\n    display: flex;\n    align-items: center;\n    font-style: italic;\n    color: #666;\n  }\n  \n  .spinner {\n    display: inline-block;\n    width: 12px;\n    height: 12px;\n    margin-right: 8px;\n    border: 2px solid #f3f3f3;\n    border-top: 2px solid #3498db;\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n  }\n  \n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  .select-all {\n    font-size: 11px;\n    color: #0366d6;\n    cursor: pointer;\n    margin-left: 16px;\n  }\n  \n  .validation-tools {\n    margin-top: 16px;\n    padding-top: 8px;\n    border-top: 1px solid #e5e5e5;\n  }\n  \n  .pill {\n    display: inline-block;\n    padding: 2px 8px;\n    margin-right: 4px;\n    border-radius: 12px;\n    font-size: 10px;\n    font-weight: 500;\n    background-color: #e1f5fe;\n    color: #0277bd;\n  }\n  \n  .export-options {\n    margin-top: 16px;\n    display: flex;\n    gap: 8px;\n  }\n  \n  .dropdown-select {\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid #ccc;\n    background-color: white;\n    font-size: 12px;\n  }",""]);const s=c},659:e=>{var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,r&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var l=t.sourceMap;l&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var l=n[o]={id:o,exports:{}};return e[o](l,l.exports,t),l.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;var o=t(72),r=t.n(o),l=t(825),c=t.n(l),s=t(659),i=t.n(s),a=t(56),d=t.n(a),p=t(540),u=t.n(p),f=t(113),g=t.n(f),m=t(628),h={};function x(e,n,t,o){if(!e||0===n.length||0===t.length)return{};const r={};for(const o of n)if(e[o]){r[o]={};for(const n of t)e[o][n]&&(r[o][n]=e[o][n]);0===Object.keys(r[o]).length&&delete r[o]}return o?function(e){const n={};function t(e,o,r,l){for(const c in l){const s=r?`${r}.${c}`:c,i=l[c];i&&"object"==typeof i&&"$value"in i?n[`${e}.${o}.${s}`]=Object.assign({},i):i&&"object"==typeof i&&!("$value"in i)?t(e,o,s,i):null!=i&&"object"!=typeof i&&(n[`${e}.${o}.${s}`]=i)}}for(const n in e)for(const o in e[n])t(n,o,"",e[n][o]);return n}(r):r}function b(e,n){const t=JSON.stringify(e,null,2),o=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(o),l=document.createElement("a");l.href=r,l.download=n,l.click(),URL.revokeObjectURL(r)}h.styleTagTransform=g(),h.setAttributes=d(),h.insert=i().bind(null,"head"),h.domAPI=c(),h.insertStyleElement=u(),r()(m.A,h),m.A&&m.A.locals&&m.A.locals;let y=null,v=[],k=[],E=[],$=!0,C=!0,w=[];const M=document.getElementById("output"),S=document.getElementById("status"),A=document.getElementById("download-btn"),L=document.getElementById("extract-btn"),I=document.getElementById("validate-btn"),j=document.getElementById("collection-list"),T=document.getElementById("mode-list"),O=document.getElementById("toggle-all-collections"),B=document.getElementById("toggle-all-modes"),N=document.getElementById("validate-references"),U=document.getElementById("flat-structure"),R=document.getElementById("separate-files"),H=document.getElementById("format-dtcg"),z=document.getElementById("format-legacy"),D=document.getElementById("reference-validation-results"),F=document.getElementById("validation-content");function W(){const e=x(y,v,k,U.checked);var n;M.textContent=(n=e,JSON.stringify(n,null,2)),A.disabled=0===Object.keys(e).length,N.checked&&(w=function(e){const n=[],t=new Map;function o(e,n=""){if(e&&"object"==typeof e&&!Array.isArray(e))if(void 0===e.$value)for(const r in e){const l=n?`${n}/${r}`:r,c=e[r];"object"==typeof c&&null!==c?o(c,l):t.set(l,c)}else t.set(n,e.$value)}function r(e,o=""){if(e&&"object"==typeof e&&!Array.isArray(e)){if(e.$value&&"string"==typeof e.$value&&e.$value.startsWith("{")&&e.$value.endsWith("}")){const r=e.$value.substring(1,e.$value.length-1);let l=!1;for(const[e,n]of t.entries())if(e===r||e.endsWith(`/${r}`)){l=!0;break}l||n.push({path:o,reference:r,message:`Reference '${r}' not found in tokens`})}for(const l in e){const c=o?`${o}/${l}`:l,s=e[l];if("object"==typeof s&&null!==s)r(s,c);else if("string"==typeof s&&s.startsWith("{")&&s.endsWith("}")){const e=s.substring(1,s.length-1);let o=!1;for(const[n,r]of t.entries())if(n===e||n.endsWith(`/${e}`)){o=!0;break}o||n.push({path:c,reference:e,message:`Reference '${e}' not found in tokens`})}}}}for(const n in e)for(const t in e[n])o(e[n][t],`${n}/${t}`);for(const n in e)for(const t in e[n])r(e[n][t],`${n}/${t}`);return n}(e),w.length>0&&(S.textContent=`Found ${w.length} reference problems. Click "Validate References" for details.`,S.className="warning"))}document.addEventListener("DOMContentLoaded",(()=>{console.log("UI loaded and initialized"),S.textContent="Extracting tokens...",S.className="info",H.addEventListener("change",W),z.addEventListener("change",W),N.addEventListener("change",W),U.addEventListener("change",W),R.addEventListener("change",W),O.addEventListener("click",(()=>{const e=function(e,n,t){const o=!e;n.querySelectorAll('input[type="checkbox"]').forEach((e=>{e.checked=o}));let r=[];return o&&t&&(r=Object.keys(t)),{areAllSelected:o,selectedCollections:r}}($,j,y);$=e.areAllSelected,v=e.selectedCollections,O.textContent=$?"Deselect All":"Select All",W()})),B.addEventListener("click",(()=>{const e=function(e,n,t){const o=!e;n.querySelectorAll('input[type="checkbox"]').forEach((e=>{e.checked=o}));let r=[];return o&&(r=[...t]),{areAllSelected:o,selectedModes:r}}(C,T,E);C=e.areAllSelected,k=e.selectedModes,B.textContent=C?"Deselect All":"Select All",W()})),I.addEventListener("click",(()=>{!function(e,n,t){if(0===e.length)n.innerHTML='<div class="success">All references are valid! Your tokens are ready to use with Style Dictionary.</div>';else{let t=`<div class="warning">Found ${e.length} reference problems:</div><ul>`;for(const n of e)t+=`<li class="reference-problem">\n                  Token at <strong>${n.path}</strong> \n                  references <strong>${n.reference}</strong> which cannot be resolved\n                 </li>`;t+="</ul>",t+='<div class="validation-tools">\n                <p>Recommendations:</p>\n                <ul>\n                  <li>Try using the "Flat Structure" option for easier reference resolution</li>\n                  <li>Check that all referenced tokens exist in the exported collections/modes</li>\n                  <li>Consider simplifying your token structure for better compatibility</li>\n                </ul>\n              </div>',n.innerHTML=t}t.style.display="block"}(w,F,D)})),L.addEventListener("click",(()=>{D.style.display="none",M.textContent="Loading data...",S.textContent="Extracting tokens...",S.className="info",j.innerHTML='\n      <div class="loading">\n        <div class="spinner"></div>\n        Loading collections...\n      </div>\n    ',T.innerHTML='\n      <div class="loading">\n        <div class="spinner"></div>\n        Loading modes...\n      </div>\n    ',A.disabled=!0,parent.postMessage({pluginMessage:{type:"extract-tokens"}},"*")})),A.addEventListener("click",(()=>{if(R.checked){const e=function(e,n,t,o){const r=x(e,n,t,o),l=[];if(o){const e=new Set;for(const n in r){const t=n.split(".");t.length>=2&&e.add(`${t[0]}.${t[1]}`)}for(const n of e){const[e,t]=n.split("."),o={};for(const e in r)e.startsWith(n)&&(o[e.substring(n.length+1)]=r[e]);Object.keys(o).length>0&&l.push({name:`${e}-${t}.json`,data:o})}}else for(const e in r)for(const n in r[e])l.push({name:`${e}-${n}.json`,data:{[e]:{[n]:r[e][n]}}});return l.push({name:"design-tokens-all.json",data:r}),l}(y,v,k,U.checked);!function(e,n,t){if(1===e.length)return void b(e[0].data,e[0].name);const o=document.createElement("div");o.style.display="none",document.body.appendChild(o);let r="<p>Multiple files are ready for download:</p><ul>";e.forEach(((e,n)=>{const t=JSON.stringify(e.data,null,2),l=new Blob([t],{type:"application/json"}),c=URL.createObjectURL(l),s=document.createElement("a");s.href=c,s.download=e.name,s.textContent=`Download ${e.name}`,s.id=`download-link-${n}`,s.className="download-link",o.appendChild(s),r+=`<li><a href="#" onclick="document.getElementById('download-link-${n}').click(); return false;">${e.name}</a></li>`})),r+="</ul>",n.innerHTML=r,t.style.display="block";const l=o.querySelector(".download-link");l&&l.click()}(e,F,D),S.textContent="Files ready for download. Click the links above to download each file.",S.className="success"}else b(x(y,v,k,U.checked),`design-tokens-${H.checked?"dtcg":"legacy"}-${(new Date).toISOString().split("T")[0]}.json`),S.textContent="Tokens downloaded successfully!",S.className="success"}))})),window.onmessage=e=>{if(console.log("UI received message:",e.data),e.data.pluginMessage){const n=e.data.pluginMessage;if("tokens-data"===n.type){console.log("UI received tokens data"),y=n.data;const e=function(e,n,t){if(!e)return{selectedCollections:[],areAllCollectionsSelected:!0};n.innerHTML="";const o=Object.keys(e);if(0===o.length)return n.innerHTML="<div>No collections found</div>",{selectedCollections:[],areAllCollectionsSelected:!0};const r=[...o];return o.forEach((o=>{const l=document.createElement("div");l.className="checkbox-item";const c=document.createElement("input");c.type="checkbox",c.id=`collection-${o}`,c.value=o,c.checked=!0,c.addEventListener("change",(()=>{const e=new Set(r);c.checked?e.add(o):e.delete(o),r.length=0,e.forEach((e=>r.push(e))),t()}));const s=document.createElement("label");s.htmlFor=`collection-${o}`;const i=Object.keys(e[o]).length;s.textContent=`${o} (${i} modes)`,l.appendChild(c),l.appendChild(s),n.appendChild(l)})),{selectedCollections:r,areAllCollectionsSelected:!0}}(y,j,W);v=e.selectedCollections,$=e.areAllCollectionsSelected;const t=function(e,n,t){if(!e)return{selectedModes:[],allModes:[],areAllModesSelected:!0};n.innerHTML="";const o=new Set;for(const n in e)for(const t in e[n])o.add(t);const r=Array.from(o);if(0===r.length)return n.innerHTML="<div>No modes found</div>",{selectedModes:[],allModes:[],areAllModesSelected:!0};const l=[...r];return r.forEach((e=>{const o=document.createElement("div");o.className="checkbox-item";const r=document.createElement("input");r.type="checkbox",r.id=`mode-${e}`,r.value=e,r.checked=!0,r.addEventListener("change",(()=>{const n=new Set(l);r.checked?n.add(e):n.delete(e),l.length=0,n.forEach((e=>l.push(e))),t()}));const c=document.createElement("label");c.htmlFor=`mode-${e}`,c.textContent=e,o.appendChild(r),o.appendChild(c),n.appendChild(o)})),{selectedModes:l,allModes:r,areAllModesSelected:!0}}(y,T,W);k=t.selectedModes,E=t.allModes,C=t.areAllModesSelected,O.textContent=$?"Deselect All":"Select All",B.textContent=C?"Deselect All":"Select All",W(),S.textContent="Tokens extracted successfully!",S.className="success"}else"error"===n.type&&(console.error("UI received error:",n.message),M.textContent="Error: "+n.message,S.textContent=n.message,S.className="error")}},console.log("UI sending ready message to plugin"),parent.postMessage({pluginMessage:{type:"ui-ready"}},"*")})();</script></body></html>