<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Design Token Export</title></head><body><h2>Design Token Export</h2><p>Extract your Figma design variables as DTCG-compliant design tokens.</p><div id="content" class="two-panel-layout"><div class="left-panel"><div class="option-group"><h3>Format Options</h3><div class="radio-item"><input type="radio" id="format-dtcg" name="format" value="dtcg" checked="checked"> <label for="format-dtcg">DTCG Format (Design Tokens Community Group)</label></div><div class="radio-item"><input type="radio" id="format-legacy" name="format" value="legacy"> <label for="format-legacy">Legacy Format (Simple JSON)</label></div><h3>Color Format</h3><div class="radio-item"><input type="radio" id="color-hex" name="color-format" value="hex" checked="checked"> <label for="color-hex">HEX (#ffffff)</label></div><div class="radio-item"><input type="radio" id="color-rgb" name="color-format" value="rgb"> <label for="color-rgb">RGB (rgb(255, 255, 255))</label></div><div class="radio-item"><input type="radio" id="color-rgba" name="color-format" value="rgba"> <label for="color-rgba">RGBA (rgba(255, 255, 255, 1))</label></div><div class="radio-item"><input type="radio" id="color-hsl" name="color-format" value="hsl"> <label for="color-hsl">HSL (hsl(0deg, 0%, 100%))</label></div><div class="radio-item"><input type="radio" id="color-hsla" name="color-format" value="hsla"> <label for="color-hsla">HSLA (hsla(0deg, 0%, 100%, 1))</label></div><h3>Export Options</h3><div class="checkbox-item"><input type="checkbox" id="separate-files" checked="checked"> <label for="separate-files">Export separate files (one per collection/mode)</label></div><div class="checkbox-item"><input type="checkbox" id="validate-references" checked="checked"> <label for="validate-references">Validate and fix references</label></div><div class="checkbox-item"><input type="checkbox" id="flat-structure"> <label for="flat-structure">Generate flat structure (easier reference resolution)</label></div></div><div class="selection-group"><h3>Collections & Modes <span class="select-all" id="toggle-all-collections">Select All</span></h3><div id="collection-modes-list"><div class="loading"><div class="spinner"></div>Loading collections and modes...</div></div></div><div><button id="extract-btn">Refresh Tokens</button> <button id="download-btn" disabled="disabled">Download JSON</button> <button id="validate-btn">Validate References</button></div></div><div class="right-panel"><div id="reference-validation-results" class="reference-validation" style="display: none;"><h3>Reference Validation</h3><div id="validation-content">Validating references...</div></div><div id="preview-container"><div class="preview-toggle-container"><h3>Preview</h3><div class="segmented-toggle" id="preview-mode-toggle"><div class="segmented-toggle-option active" data-mode="json">JSON</div><div class="segmented-toggle-option" data-mode="visual">Visual</div></div></div><div class="preview-content-json active"><div class="preview-tabs" id="preview-tabs"><button class="tab-button active" data-tab="combined">Combined</button></div><div class="preview-content"><div class="tab-content" id="tab-combined" style="display: block;"><pre id="output">Loading data...</pre></div></div></div><div class="preview-content-visual" id="visual-preview-container"></div></div></div></div><div id="status" class="info">Waiting for data...</div><script>(()=>{"use strict";var e={56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var a={},r=[],s=0;s<e.length;s++){var l=e[s],d=o.base?l[0]+o.base:l[0],c=a[d]||0,p="".concat(d," ").concat(c);a[d]=c+1;var f=t(p),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)n[f].references++,n[f].updater(u);else{var v=i(u,o);o.byIndex=s,n.splice(s,0,{identifier:p,updater:v,references:1})}r.push(p)}return r}function i(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,i){var a=o(e=e||[],i=i||{});return function(e){e=e||[];for(var r=0;r<a.length;r++){var s=t(a[r]);n[s].references--}for(var l=o(e,i),d=0;d<a.length;d++){var c=t(a[d]);0===n[c].references&&(n[c].updater(),n.splice(c,1))}a=l}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},210:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(601),i=t.n(o),a=t(314),r=t.n(a)()(i());r.push([e.id,"/* Two-panel layout styles */\n.two-panel-layout {\n    display: flex;\n    gap: 16px;\n    margin-bottom: 16px;\n  }\n  \n  .left-panel {\n    flex: 0 0 280px;\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n  }\n  \n  .right-panel {\n    flex: 1;\n    min-width: 0; /* Ensures the panel doesn't overflow its container */\n    display: flex;\n    flex-direction: column;\n  }\n  \n  /* Make the preview container take the full available height */\n  #preview-container {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    min-height: 400px;\n  }\n  \n  /* Ensure the preview content expands to fill available space */\n  .preview-content {\n    flex: 1;\n    min-height: 300px;\n    display: flex;\n    flex-direction: column;\n  }\n  \n  .preview-content pre {\n    flex: 1;\n    margin: 0;\n    min-height: 200px;\n  }\n  \n  /* Scrollable areas for collections and modes */\n  #collection-modes-list {\n    max-height: 320px;\n    overflow-y: auto;\n    padding-right: 8px;\n  }\n  \n  /* Improved styling for collection/mode lists */\n  .collection-item {\n    margin-bottom: 10px;\n    border-left: 3px solid #e0e0e0;\n    padding-left: 8px;\n  }\n  \n  .collection-header {\n    display: flex;\n    align-items: center;\n    font-weight: 500;\n    margin-bottom: 4px;\n    padding: 4px;\n    border-radius: 4px;\n    background-color: #f0f0f0;\n  }\n  \n  .collection-header:hover {\n    background-color: #e5e5e5;\n  }\n  \n  .mode-container {\n    margin-left: 20px;\n    padding-top: 2px;\n    padding-bottom: 2px;\n  }\n  \n  .mode-item {\n    display: flex;\n    align-items: center;\n    padding: 3px 0;\n  }\n  \n  .mode-item label {\n    margin-left: 8px;\n    cursor: pointer;\n  }\n  \n  /* Responsive adjustments */\n  @media (max-width: 700px) {\n    .two-panel-layout {\n      flex-direction: column;\n    }\n    \n    .left-panel {\n      flex: none;\n      width: 100%;\n    }\n    \n    .right-panel {\n      width: 100%;\n    }\n  }",""]);const s=r},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",o=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),o&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),o&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,o,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(o)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(r[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);o&&r[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),t&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=t):c[2]=t),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),n.push(c))}},n}},394:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(601),i=t.n(o),a=t(314),r=t.n(a)()(i());r.push([e.id,'/* Tab styling fixes */\n\n.preview-tabs {\n  display: flex;\n  flex-wrap: wrap;\n  border-bottom: 1px solid #ddd;\n  margin-bottom: 10px;\n  gap: 4px;\n}\n\n.tab-button {\n  padding: 6px 12px;\n  background-color: #f0f0f0;\n  border: 1px solid #ddd;\n  border-bottom: none;\n  border-radius: 4px 4px 0 0;\n  cursor: pointer;\n  font-size: 11px;\n  font-weight: 500;\n  color: #555;\n  position: relative;\n  bottom: -1px;\n  margin-bottom: 0;\n  margin-top: 0; /* Override the general button margin */\n}\n\n.tab-button:hover {\n  background-color: #e5e5e5;\n}\n\n.tab-button.active {\n  background-color: white;\n  border-bottom: 1px solid white;\n  color: #18a0fb;\n  z-index: 1;\n}\n\n.preview-content {\n  position: relative;\n  border: 1px solid #ddd;\n  border-top: none;\n  padding: 10px;\n  border-radius: 0 0 4px 4px;\n  background-color: white;\n}\n\n.tab-content {\n  display: none; /* Hide all tab content by default */\n}\n\n/* Make sure the active tab content is visible */\n.tab-content.active,\n.tab-content[style*="display: block"] {\n  display: block !important;\n}\n\n/* Fix any overflow issues */\n.preview-content pre {\n  margin: 0;\n  white-space: pre-wrap;\n  word-break: break-word;\n  overflow-x: auto;\n}',""]);const s=r},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},560:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(601),i=t.n(o),a=t(314),r=t.n(a)()(i());r.push([e.id,"/* Token Preview Styles */\n.token-preview-wrapper {\n  margin-top: 16px;\n}\n\n.token-preview-container {\n  border: 1px solid #e5e5e5;\n  border-radius: 4px;\n  overflow: hidden;\n  background: white;\n}\n\n.token-preview-heading {\n  background-color: #f0f0f0;\n  padding: 8px 12px;\n  font-weight: 600;\n  font-size: 12px;\n  border-bottom: 1px solid #e5e5e5;\n}\n\n.token-preview-subheading {\n  padding: 6px 12px;\n  font-weight: 500;\n  font-size: 11px;\n  background-color: #f9f9f9;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n/* Grid layout for token items */\n.token-preview-items-grid {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 2px;\n  padding: 2px;\n  background-color: #f0f0f0;\n}\n\n.token-preview-item {\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  background-color: white;\n  transition: all 0.2s ease;\n  flex: 1 0 calc(50% - 2px);\n  max-width: calc(50% - 2px);\n  min-width: 200px;\n  box-sizing: border-box;\n  border-radius: 3px;\n}\n\n.token-preview-item:hover {\n  background-color: #f9f9f9;\n  transform: translateY(-1px);\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);\n}\n\n/* Color tokens */\n.color-swatch {\n  width: 48px;\n  height: 48px;\n  border-radius: 8px;\n  margin-right: 12px;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  position: relative;\n  flex-shrink: 0;\n}\n\n.color-swatch.transparent {\n  background-image: \n    linear-gradient(45deg, #eee 25%, transparent 25%),\n    linear-gradient(-45deg, #eee 25%, transparent 25%),\n    linear-gradient(45deg, transparent 75%, #eee 75%),\n    linear-gradient(-45deg, transparent 75%, #eee 75%);\n  background-size: 10px 10px;\n  background-position: 0 0, 0 5px, 5px -5px, -5px 0px;\n}\n\n/* Reference tokens */\n/* Kun anvend mønsterbaggrund til uløste referencer */\n.color-swatch.reference-token.unresolved-reference {\n  background-image: \n    linear-gradient(45deg, #f0f0f0 25%, #cccccc 25%),\n    linear-gradient(-45deg, #f0f0f0 25%, #cccccc 25%),\n    linear-gradient(45deg, #cccccc 75%, #f0f0f0 75%),\n    linear-gradient(-45deg, #cccccc 75%, #f0f0f0 75%);\n  background-size: 8px 8px;\n  border: 1px dashed #999;\n}\n\n/* Løste reference tokens – vis den faktiske farve */\n.color-swatch.reference-token.resolved-reference {\n  /* Ingen background-image, så baggrundsfarven træder frem */\n}\n\n/* Tilføj en referenceindikator i hjørnet */\n.reference-icon {\n  position: absolute;\n  top: -1px;\n  right: -1px;\n  width: 12px;\n  height: 12px;\n  color: #0366d6;\n  font-size: 9px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\n  z-index: 2;\n}\n\n.reference-label {\n  display: inline-block;\n  margin-left: 4px;\n  padding: 1px 4px;\n  background: #e8f0fe;\n  color: #0366d6;\n  font-size: 8px;\n  border-radius: 2px;\n  vertical-align: middle;\n}\n\n.resolved-value {\n  display: inline-block;\n  margin-left: 4px;\n  padding: 1px 4px;\n  background: #e6ffed;\n  color: #22863a;\n  font-size: 8px;\n  border-radius: 2px;\n  vertical-align: middle;\n}\n\n/* Token info struktur */\n.token-info {\n  flex: 1;\n  margin-left: 6px;\n  overflow: hidden;\n}\n\n.token-path {\n  font-weight: 500;\n  font-size: 12px;\n  color: #333;\n  margin-bottom: 4px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.token-value {\n  font-family: monospace;\n  font-size: 11px;\n  color: #666;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* Dimension tokens */\n.dimension-swatch {\n  height: 16px;\n  display: flex;\n  align-items: center;\n  margin-right: 12px;\n  min-width: 90px;\n  max-width: 120px;\n  position: relative;\n  flex-shrink: 0;\n}\n\n.dimension-bar {\n  height: 6px;\n  background-color: #0366d6;\n  border-radius: 3px;\n  min-width: 4px;\n}\n\n/* Typography tokens */\n.font-family-sample,\n.font-weight-sample {\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-right: 12px;\n  background: #f5f5f5;\n  border-radius: 4px;\n  font-size: 18px;\n}\n\n.font-size-sample {\n  height: 40px;\n  min-width: 40px;\n  display: flex;\n  align-items: center;\n  margin-right: 12px;\n  background: #f5f5f5;\n  padding: 0 8px;\n  border-radius: 4px;\n  line-height: 1;\n  overflow: hidden;\n}\n\n.line-height-sample {\n  width: 80px;\n  min-height: 40px;\n  display: flex;\n  align-items: center;\n  margin-right: 12px;\n  background: #f5f5f5;\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 10px;\n  line-height: inherit;\n  overflow: hidden;\n}\n\n.letter-spacing-sample {\n  height: 40px;\n  min-width: 80px;\n  display: flex;\n  align-items: center;\n  margin-right: 12px;\n  background: #f5f5f5;\n  padding: 0 8px;\n  border-radius: 4px;\n  font-size: 14px;\n  overflow: hidden;\n}\n\n/* Duration tokens */\n.duration-swatch {\n  width: 100px;\n  height: 16px;\n  margin-right: 12px;\n  background: #f5f5f5;\n  border-radius: 8px;\n  overflow: hidden;\n  position: relative;\n}\n\n.duration-bar {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  background: linear-gradient(90deg, transparent, #0366d6, transparent);\n  animation: duration-animation 2s infinite;\n  transform: translateX(-100%);\n}\n\n@keyframes duration-animation {\n  0% { transform: translateX(-100%); }\n  100% { transform: translateX(100%); }\n}\n\n/* Shadow tokens */\n.shadow-swatch {\n  width: 60px;\n  height: 40px;\n  margin-right: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.shadow-box {\n  width: 40px;\n  height: 20px;\n  background: white;\n  border-radius: 4px;\n}\n\n/* Generic tokens */\n.generic-swatch {\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n  margin-right: 12px;\n  background: #f0f0f0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n}\n\n.generic-indicator {\n  font-size: 12px;\n  font-weight: bold;\n  color: #666;\n}\n\n/* Mindre referenceikon for ikke-farvetokens */\n.reference-icon-small {\n  position: absolute;\n  top: -2px;\n  right: -2px;\n  width: 10px;\n  height: 10px;\n  background: #0366d6;\n  color: white;\n  font-size: 8px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1;\n}\n\n/* Reference visualisering i token-detalje-panelet */\n.reference-visualization {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px;\n  background: #f5f5f5;\n  border-radius: 4px;\n}\n\n.reference-token-wrapper,\n.reference-target-wrapper {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  min-width: 100px;\n}\n\n.reference-token-wrapper {\n  color: #0366d6;\n  font-family: monospace;\n  font-size: 11px;\n}\n\n.reference-target-wrapper {\n  color: #22863a;\n  font-family: monospace;\n  font-size: 11px;\n}\n\n.reference-preview {\n  margin-top: 4px;\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n}\n\n.reference-arrow {\n  font-size: 18px;\n  color: #0366d6;\n  margin: 0 8px;\n}\n\n/* Token detail panel */\n.token-detail-panel {\n  position: absolute;\n  z-index: 10;\n  background: white;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n  padding: 12px;\n  min-width: 260px;\n  max-width: 400px;\n}\n\n.token-detail-header {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 12px;\n}\n\n.token-detail-title {\n  font-weight: 600;\n  font-size: 12px;\n}\n\n.token-detail-close {\n  cursor: pointer;\n  font-size: 16px;\n  line-height: 1;\n  color: #999;\n}\n\n.token-detail-content {\n  margin-bottom: 12px;\n}\n\n.token-detail-row {\n  display: flex;\n  margin-bottom: 6px;\n  font-size: 11px;\n}\n\n.token-detail-label {\n  font-weight: 500;\n  width: 80px;\n  color: #666;\n}\n\n.token-detail-value {\n  font-family: monospace;\n  flex: 1;\n  word-break: break-all;\n}\n\n.token-usage-label {\n  font-weight: 500;\n  font-size: 11px;\n  margin-top: 12px;\n  margin-bottom: 4px;\n  color: #666;\n}\n\n.token-copy-button {\n  font-size: 10px;\n  padding: 2px 6px;\n  background: #f5f5f5;\n  border: 1px solid #ddd;\n  border-radius: 3px;\n  cursor: pointer;\n  margin-left: 4px;\n}\n\n.token-copy-button:hover {\n  background: #e5e5e5;\n}\n\n.token-visualization {\n  margin-top: 8px;\n  padding: 8px;\n  background: #f9f9f9;\n  border-radius: 4px;\n  max-height: 80px;\n  overflow: hidden;\n}\n\n/* Visuel indikator for løst reference */\n.color-swatch.reference-token.resolved-reference::after {\n  content: '';\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 8px 8px 0;\n  border-color: transparent #ffffff transparent transparent;\n}\n\n/* Responsive justeringer */\n@media (max-width: 600px) {\n  .token-preview-item {\n    flex: 1 0 100%;\n    max-width: 100%;\n  }\n}",""]);const s=r},601:e=>{e.exports=function(e){return e[1]}},628:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(601),i=t.n(o),a=t(314),r=t.n(a)()(i());r.push([e.id,"body {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    margin: 0;\n    padding: 20px;\n    font-size: 12px;\n    color: #333;\n  }\n  \n  h2 {\n    margin-bottom: 16px;\n    font-size: 16px;\n    font-weight: 600;\n  }\n  \n  h3 {\n    margin-top: 16px;\n    margin-bottom: 8px;\n    font-size: 14px;\n    font-weight: 500;\n  }\n  \n  p {\n    margin-bottom: 16px;\n    color: #666;\n  }\n  \n  button {\n    background-color: #18a0fb;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    padding: 8px 16px;\n    margin-right: 8px;\n    margin-top: 16px;\n    cursor: pointer;\n    font-weight: 500;\n  }\n  \n  button:hover {\n    background-color: #0d8ce0;\n  }\n  \n  button:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n  }\n  \n  .selection-group {\n    margin-top: 16px;\n    margin-bottom: 16px;\n    padding: 12px;\n    border: 1px solid #e5e5e5;\n    border-radius: 4px;\n    background-color: #f9f9f9;\n  }\n  \n  .option-group {\n    margin-top: 16px;\n    margin-bottom: 16px;\n    padding: 12px;\n    border: 1px solid #e5e5e5;\n    border-radius: 4px;\n    background-color: #f0f7ff;\n  }\n  \n  .checkbox-item {\n    display: flex;\n    align-items: center;\n    margin-bottom: 8px;\n  }\n  \n  .checkbox-item label {\n    margin-left: 8px;\n    cursor: pointer;\n  }\n  \n  .radio-item {\n    display: flex;\n    align-items: center;\n    margin-bottom: 8px;\n  }\n  \n  .radio-item label {\n    margin-left: 8px;\n    cursor: pointer;\n  }\n  \n  .mode-container {\n    margin-left: 24px;\n    padding-top: 4px;\n  }\n  \n  pre {\n    background-color: #f5f5f5;\n    padding: 10px;\n    border-radius: 4px;\n    overflow: auto;\n    max-height: 300px;\n    font-family: monospace;\n    font-size: 11px;\n  }\n  \n  .reference-validation {\n    background-color: #fff8e1;\n    padding: 10px;\n    border-radius: 4px;\n    border-left: 4px solid #ffca28;\n    margin-top: 16px;\n    font-size: 11px;\n  }\n  \n  .reference-problem {\n    color: #d32f2f;\n    font-weight: 500;\n    padding: 4px 0;\n  }\n  \n  #status {\n    margin-top: 16px;\n    padding: 8px 12px;\n    border-radius: 4px;\n    font-size: 12px;\n  }\n  \n  .info {\n    background-color: #e8f4fd;\n    color: #0366d6;\n  }\n  \n  .success {\n    background-color: #e6ffed;\n    color: #22863a;\n  }\n  \n  .warning {\n    background-color: #fff8e1;\n    color: #b08800;\n  }\n  \n  .error {\n    background-color: #ffeef0;\n    color: #d73a49;\n  }\n  \n  .loading {\n    display: flex;\n    align-items: center;\n    font-style: italic;\n    color: #666;\n  }\n  \n  .spinner {\n    display: inline-block;\n    width: 12px;\n    height: 12px;\n    margin-right: 8px;\n    border: 2px solid #f3f3f3;\n    border-top: 2px solid #3498db;\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n  }\n  \n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  .select-all {\n    font-size: 11px;\n    color: #0366d6;\n    cursor: pointer;\n    margin-left: 16px;\n  }\n  \n  .validation-tools {\n    margin-top: 16px;\n    padding-top: 8px;\n    border-top: 1px solid #e5e5e5;\n  }\n  \n  .pill {\n    display: inline-block;\n    padding: 2px 8px;\n    margin-right: 4px;\n    border-radius: 12px;\n    font-size: 10px;\n    font-weight: 500;\n    background-color: #e1f5fe;\n    color: #0277bd;\n  }\n  \n  .export-options {\n    margin-top: 16px;\n    display: flex;\n    gap: 8px;\n  }\n  \n  .dropdown-select {\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid #ccc;\n    background-color: white;\n    font-size: 12px;\n  }",""]);const s=r},659:e=>{var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var i=void 0!==t.layer;i&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,i&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},903:(e,n,t)=>{t.d(n,{A:()=>s});var o=t(601),i=t.n(o),a=t(314),r=t.n(a)()(i());r.push([e.id,"/* Segmented toggle styles */\n.preview-toggle-container {\n  display: flex;\n  margin-bottom: 12px;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.preview-toggle-container h3 {\n  margin: 0;\n}\n\n.segmented-toggle {\n  display: flex;\n  background-color: #f0f0f0;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  overflow: hidden;\n  height: 28px;\n}\n\n.segmented-toggle-option {\n  padding: 4px 12px;\n  cursor: pointer;\n  font-size: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 80px;\n  transition: background-color 0.2s, color 0.2s;\n  user-select: none;\n}\n\n.segmented-toggle-option:not(:last-child) {\n  border-right: 1px solid #ddd;\n}\n\n.segmented-toggle-option.active {\n  background-color: #18a0fb;\n  color: white;\n  font-weight: 500;\n}\n\n.segmented-toggle-option:not(.active):hover {\n  background-color: #e5e5e5;\n}\n\n/* Custom styles for preview containers */\n.preview-content-json,\n.preview-content-visual {\n  display: none;\n}\n\n.preview-content-json.active,\n.preview-content-visual.active {\n  display: block;\n}",""]);const s=r}},n={};function t(o){var i=n[o];if(void 0!==i)return i.exports;var a=n[o]={id:o,exports:{}};return e[o](a,a.exports,t),a.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0;var o=t(72),i=t.n(o),a=t(825),r=t.n(a),s=t(659),l=t.n(s),d=t(56),c=t.n(d),p=t(540),f=t.n(p),u=t(113),v=t.n(u),g=t(628),h={};h.styleTagTransform=v(),h.setAttributes=c(),h.insert=l().bind(null,"head"),h.domAPI=r(),h.insertStyleElement=f(),i()(g.A,h),g.A&&g.A.locals&&g.A.locals;var m=t(394),b={};b.styleTagTransform=v(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=f(),i()(m.A,b),m.A&&m.A.locals&&m.A.locals;var x=t(560),y={};y.styleTagTransform=v(),y.setAttributes=c(),y.insert=l().bind(null,"head"),y.domAPI=r(),y.insertStyleElement=f(),i()(x.A,y),x.A&&x.A.locals&&x.A.locals;var k=t(903),w={};w.styleTagTransform=v(),w.setAttributes=c(),w.insert=l().bind(null,"head"),w.domAPI=r(),w.insertStyleElement=f(),i()(k.A,w),k.A&&k.A.locals&&k.A.locals;var $=t(210),E={};function C(e){return JSON.stringify(e,null,2)}function S(e,n,t,o){if(!e||0===n.length||0===t.length)return{};const i={};for(const o of n)if(e[o]){i[o]={};for(const n in e[o])t.includes(n)&&(i[o][n]=e[o][n]);0===Object.keys(i[o]).length&&delete i[o]}return o?function(e){const n={};function t(e,o,i,a){for(const r in a){const s=i?`${i}.${r}`:r,l=a[r];l&&"object"==typeof l&&"$value"in l?n[`${e}.${o}.${s}`]=Object.assign({},l):l&&"object"==typeof l&&!("$value"in l)?t(e,o,s,l):null!=l&&"object"!=typeof l&&(n[`${e}.${o}.${s}`]=l)}}for(const n in e)for(const o in e[n])t(n,o,"",e[n][o]);return n}(i):i}function j(e,n){const t=JSON.stringify(e,null,2),o=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(o),a=document.createElement("a");a.href=i,a.download=n,a.click(),URL.revokeObjectURL(i)}function L(e,n,t,o,i){console.log(`Setting active tab: ${e}`);const a=n.querySelectorAll(".tab-button"),r=t.querySelectorAll(".tab-content");a.forEach((e=>e.classList.remove("active"))),r.forEach((e=>{e.style.display="none"}));const s=n.querySelector(`.tab-button[data-tab="${e}"]`);s?s.classList.add("active"):console.error(`Tab button not found: ${e}`);const l=document.getElementById(`tab-${e}`);l?l.style.display="block":console.error(`Tab content not found: tab-${e}`),o&&i&&i(o)}function A(e,n){const t={};return function e(n,o){if(n&&"object"==typeof n)if(void 0===n.$value)for(const i in n){const a=o?`${o}.${i}`:i;"object"==typeof n[i]&&null!==n[i]?e(n[i],a):t[a]=n[i]}else t[o]=Object.assign({},n);else t[o]=n}(n,e),t}function T(e){const n={};function t(e,o="",i=""){if(e&&"object"==typeof e)if(void 0===e.$value||void 0===e.$type)for(const n in e){const a=o?`${o}/${n}`:n,r=i?`${i}.${n}`:n;"object"==typeof e[n]&&null!==e[n]&&t(e[n],a,r)}else{const t=o.replace(/\//g,".");n[t]={value:e.$value,type:e.$type,originalPath:i},n[o]={value:e.$value,type:e.$type,originalPath:i};const a=o.split(/[\/\.]/),r=a[a.length-1];r&&r!==o&&(n[r]||(n[r]={value:e.$value,type:e.$type,originalPath:i}));let s="",l="";for(let d=a.length-1;d>=0;d--)s?(s=a[d]+"/"+s,l=a[d]+"."+l):(s=a[d],l=a[d]),n[s]||s===o||s===r||(n[s]={value:e.$value,type:e.$type,originalPath:i}),n[l]||l===t||l===r||(n[l]={value:e.$value,type:e.$type,originalPath:i})}}for(const n in e)for(const o in e[n])t(e[n][o],`${n}/${o}`,`${n}.${o}`);return n}function R(e,n,t=new Set){if(!e||"string"!=typeof e)return{value:e,type:"unknown",isResolved:!1};if(!e.startsWith("{")||!e.endsWith("}"))return{value:e,type:"unknown",isResolved:!1};const o=e.substring(1,e.length-1);if(t.has(o))return console.warn(`Circular reference detected: ${o}`),{value:e,type:"reference",originalReference:e,isResolved:!1};if(t.add(o),n[o]){const i=n[o];if("string"==typeof i.value&&i.value.startsWith("{")&&i.value.endsWith("}")){const a=R(i.value,n,t);return Object.assign(Object.assign({},a),{originalReference:e,originalPath:i.originalPath,resolvedFrom:o})}return{value:i.value,type:i.type,originalReference:e,originalPath:i.originalPath,isResolved:!0,resolvedFrom:o}}const i=o.includes("/")?o.replace(/\//g,"."):o.replace(/\./g,"/");if(n[i]){const o=n[i];if("string"==typeof o.value&&o.value.startsWith("{")&&o.value.endsWith("}")){const a=R(o.value,n,t);return Object.assign(Object.assign({},a),{originalReference:e,originalPath:o.originalPath,resolvedFrom:i})}return{value:o.value,type:o.type,originalReference:e,originalPath:o.originalPath,isResolved:!0,resolvedFrom:i}}for(const a in n)if(a!==o&&(a.endsWith(`/${o}`)||a.endsWith(`.${o}`)||a.endsWith(`/${i}`)||a.endsWith(`.${i}`))){const o=n[a];if("string"==typeof o.value&&o.value.startsWith("{")&&o.value.endsWith("}")){const i=R(o.value,n,t);return Object.assign(Object.assign({},i),{originalReference:e,originalPath:o.originalPath,resolvedFrom:a})}return{value:o.value,type:o.type,originalReference:e,originalPath:o.originalPath,isResolved:!0,resolvedFrom:a}}const a=o.split(/[\/\.]/);for(let o=a.length-1;o>0;o--){const i=a.slice(a.length-o).join("/"),r=a.slice(a.length-o).join(".");if(n[i]){const o=n[i];if("string"==typeof o.value&&o.value.startsWith("{")&&o.value.endsWith("}")){const a=R(o.value,n,t);return Object.assign(Object.assign({},a),{originalReference:e,originalPath:o.originalPath,resolvedFrom:i})}return{value:o.value,type:o.type,originalReference:e,originalPath:o.originalPath,isResolved:!0,resolvedFrom:i}}if(n[r]){const o=n[r];if("string"==typeof o.value&&o.value.startsWith("{")&&o.value.endsWith("}")){const i=R(o.value,n,t);return Object.assign(Object.assign({},i),{originalReference:e,originalPath:o.originalPath,resolvedFrom:r})}return{value:o.value,type:o.type,originalReference:e,originalPath:o.originalPath,isResolved:!0,resolvedFrom:r}}}return{value:e,type:"reference",originalReference:e,isResolved:!1}}function z(e){const n=T(e),t=[],o=[];function i(e,r=""){if(e&&"object"==typeof e){if(void 0!==e.$value&&"string"==typeof e.$value&&e.$value.startsWith("{")&&e.$value.endsWith("}")){const i=e.$value,s=i.substring(1,i.length-1);if(!R(i,n).isResolved){const e=function(e,n){const t=[];for(const o in n){const n=a(e,o);if(n>.5){const e=o.replace(/\//g,".");t.push({path:e,similarity:n})}}return t.sort(((e,n)=>n.similarity-e.similarity)).slice(0,5)}(s,n);if(t.push({path:r,reference:s,potentialMatches:e}),e.length>0&&e[0].similarity>.7){const n=e[0].path.replace(/\//g,".");o.push({path:r,original:i,suggested:`{${n}}`})}}}if(Array.isArray(e))e.forEach(((e,n)=>{i(e,`${r}[${n}]`)}));else for(const n in e){const t=r?`${r}.${n}`:n;i(e[n],t)}}}function a(e,n){const t=e.toLowerCase(),o=n.toLowerCase(),i=t.replace(/\//g,"."),a=o.replace(/\//g,".");if(i.includes(a)||a.includes(i))return.8;const r=i.split("."),s=a.split(".");let l=0;for(const e of r)s.includes(e)&&l++;if(l>0)return.5+.5*l/Math.max(r.length,s.length);let d=0;const c=Math.min(i.length,a.length);for(let e=0;e<c;e++)i[e]===a[e]&&d++;return d/Math.max(i.length,a.length)}for(const n in e)for(const t in e[n])i(e[n][t],`${n}.${t}`);return{unresolvedReferences:t,suggestedFixes:o}}function M(e,n,t,o){const i=function(e){const n=[];function t(e,o=""){if(e&&"object"==typeof e)if(void 0===e.$value||void 0===e.$type)for(const i in e){const a=o?`${o}/${i}`:i,r=e[i];if("object"==typeof r&&null!==r)t(r,a);else{const e=F(r);e&&n.push({path:a,type:e,value:r,originalValue:r})}}else n.push({path:o,type:e.$type,value:e.$value,originalValue:e.$value})}for(const n in e)for(const o in e[n])t(e[n][o],`${n}/${o}`);return n}(e),a=T(e),{numResolved:r,numUnresolved:s}=function(e,n){let t=0,o=0;for(const i of e){const e=i.value;if("string"==typeof e&&e.startsWith("{")&&e.endsWith("}")){const a=R(e,n);a.isResolved?(i.referencedValue=a.value,i.referencedType=a.type,i.resolvedFrom=a.resolvedFrom,"reference"===i.type&&a.type&&(i.type=a.type),t++):o++}}return{numResolved:t,numUnresolved:o}}(i,a);o&&o(r,s);const l=n.querySelector(".token-preview-wrapper");l&&l.remove();const d=function(e){if(0===e.length)return'<div class="token-preview-container"><div class="token-preview-heading">No tokens found</div></div>';const n={};e.forEach((e=>{n[e.type]||(n[e.type]=[]),n[e.type].push(e)}));let t='<div class="token-preview-container">';t+='<div class="token-preview-heading">Visual Token Preview</div>',n.color&&(t+=function(e){let n='<div class="token-preview-heading">Color Tokens</div>';const t={};e.forEach((e=>{const n=e.path.split("/");if(n.length>=2){const o=n[0];t[o]||(t[o]=[]),t[o].push(e)}}));for(const e in t)n+=`<div class="token-preview-subheading">${e}</div>`,n+='<div class="token-preview-items-grid">',t[e].forEach((e=>{const t="string"==typeof e.value&&e.value.startsWith("{")&&e.value.endsWith("}");let o,i="",a="",r="";t?void 0!==e.referencedValue?(o=e.referencedValue,i="reference-token resolved-reference",e.value,r=e.resolvedFrom?`data-resolved-from="${e.resolvedFrom}"`:""):(o="#cccccc",i="reference-token unresolved-reference"):(o=e.value,(String(e.value).includes("rgba")||String(e.value).includes("hsla")||String(e.value).startsWith("#")&&9===String(e.value).length)&&(i="transparent"));const s=e.path.split("/").slice(2).join("/");n+=`\n        <div class="token-preview-item color-preview-item" \n             data-token-path="${e.path}" \n             data-token-value="${e.value}" \n             data-token-type="${e.type}"\n             ${e.referencedValue?`data-referenced-value="${e.referencedValue}"`:""}\n             ${e.referencedType?`data-referenced-type="${e.referencedType}"`:""}\n             ${r}>\n          <div class="color-swatch ${i}" style="background-color: ${o}">\n            ${t?'<div class="reference-icon">↗</div>':""}\n          </div>\n          <div class="token-info">\n            <div class="token-path">${s}</div>\n            <div class="token-value">\n              ${e.value}\n              ${t?'<span class="reference-label">Reference</span>':""}\n              ${t&&e.referencedValue?`<span class="resolved-value">${e.referencedValue}</span>`:""}\n            </div>\n          </div>\n        </div>\n      `})),n+="</div>";return n}(n.color)),n.dimension&&(t+=function(e){let n='<div class="token-preview-heading">Dimension Tokens</div>';const t={};e.forEach((e=>{const n=e.path.split("/");if(n.length>=2){const o=n[0];t[o]||(t[o]=[]),t[o].push(e)}}));for(const e in t)n+=`<div class="token-preview-subheading">${e}</div>`,n+='<div class="token-preview-items-grid">',t[e].forEach((e=>{const t="string"==typeof e.value&&e.value.startsWith("{")&&e.value.endsWith("}"),o=t&&void 0!==e.referencedValue?e.referencedValue:e.value,i=e.path.split("/").slice(2).join("/"),a=String(o).replace(/[^0-9.]/g,""),r=Math.min(parseFloat(a)||0,200),s=e.resolvedFrom?`data-resolved-from="${e.resolvedFrom}"`:"";n+=`\n        <div class="token-preview-item dimension-preview-item" \n             data-token-path="${e.path}" \n             data-token-value="${e.value}" \n             data-token-type="${e.type}"\n             ${e.referencedValue?`data-referenced-value="${e.referencedValue}"`:""}\n             ${e.referencedType?`data-referenced-type="${e.referencedType}"`:""}\n             ${s}>\n          <div class="dimension-swatch">\n            <div class="dimension-bar" style="width: ${r}px"></div>\n            ${t?'<div class="reference-icon-small">↗</div>':""}\n          </div>\n          <div class="token-info">\n            <div class="token-path">${i}</div>\n            <div class="token-value">\n              ${e.value}\n              ${t?'<span class="reference-label">Reference</span>':""}\n              ${t&&e.referencedValue?`<span class="resolved-value">${e.referencedValue}</span>`:""}\n            </div>\n          </div>\n        </div>\n      `})),n+="</div>";return n}(n.dimension));const o=["fontFamily","fontWeight","fontSize","lineHeight","letterSpacing"];let i=!1;for(const e of o)if(n[e]&&n[e].length>0){i=!0;break}if(i){t+='<div class="token-preview-heading">Typography Tokens</div>';for(const e of o)n[e]&&(t+=W(n[e],e))}n.duration&&(t+=function(e){let n='<div class="token-preview-heading">Duration Tokens</div>';return n+='<div class="token-preview-items-grid">',e.forEach((e=>{const t="string"==typeof e.value&&e.value.startsWith("{")&&e.value.endsWith("}"),o=t&&void 0!==e.referencedValue?e.referencedValue:e.value,i=e.path.split("/").slice(2).join("/");let a=1e3;const r=String(o);r.includes("ms")?a=parseFloat(r):r.includes("s")&&(a=1e3*parseFloat(r));const s=Math.min(a/1e3,5),l=e.resolvedFrom?`data-resolved-from="${e.resolvedFrom}"`:"";n+=`\n      <div class="token-preview-item duration-preview-item" \n           data-token-path="${e.path}" \n           data-token-value="${e.value}" \n           data-token-type="${e.type}"\n           ${e.referencedValue?`data-referenced-value="${e.referencedValue}"`:""}\n           ${e.referencedType?`data-referenced-type="${e.referencedType}"`:""}\n           ${l}>\n        <div class="duration-swatch">\n          <div class="duration-bar" style="animation-duration: ${s}s"></div>\n          ${t?'<div class="reference-icon-small">↗</div>':""}\n        </div>\n        <div class="token-info">\n          <div class="token-path">${i}</div>\n          <div class="token-value">\n            ${e.value}\n            ${t?'<span class="reference-label">Reference</span>':""}\n            ${t&&e.referencedValue?`<span class="resolved-value">${e.referencedValue}</span>`:""}\n          </div>\n        </div>\n      </div>\n    `})),n+="</div>",n}(n.duration)),n.shadow&&(t+=function(e){let n='<div class="token-preview-heading">Shadow Tokens</div>';return n+='<div class="token-preview-items-grid">',e.forEach((e=>{const t="string"==typeof e.value&&e.value.startsWith("{")&&e.value.endsWith("}"),o=t&&void 0!==e.referencedValue?e.referencedValue:e.value,i=e.path.split("/").slice(2).join("/"),a=e.resolvedFrom?`data-resolved-from="${e.resolvedFrom}"`:"";n+=`\n      <div class="token-preview-item shadow-preview-item" \n           data-token-path="${e.path}" \n           data-token-value="${e.value}" \n           data-token-type="${e.type}"\n           ${e.referencedValue?`data-referenced-value="${e.referencedValue}"`:""}\n           ${e.referencedType?`data-referenced-type="${e.referencedType}"`:""}\n           ${a}>\n        <div class="shadow-swatch">\n          <div class="shadow-box" style="box-shadow: ${o}"></div>\n          ${t?'<div class="reference-icon-small">↗</div>':""}\n        </div>\n        <div class="token-info">\n          <div class="token-path">${i}</div>\n          <div class="token-value">\n            ${e.value}\n            ${t?'<span class="reference-label">Reference</span>':""}\n            ${t&&e.referencedValue?`<span class="resolved-value">${e.referencedValue}</span>`:""}\n          </div>\n        </div>\n      </div>\n    `})),n+="</div>",n}(n.shadow));const a=new Set(["color","dimension","fontFamily","fontWeight","fontSize","lineHeight","letterSpacing","duration","shadow"]);let r=!1;for(const e in n)if(!a.has(e)){r=!0;break}if(r){t+='<div class="token-preview-heading">Other Tokens</div>';for(const e in n)a.has(e)||(t+=N(n[e],e))}return t+="</div>",t}(i),c=document.createElement("div");c.className="token-preview-wrapper",c.innerHTML=d,n.appendChild(c),function(e){e.addEventListener("click",(e=>{const n=e.target.closest(".token-preview-item");n&&function(e,n,t,o,i="",a="",r=""){document.querySelectorAll(".token-detail-panel").forEach((e=>{e.remove()}));const s=document.createElement("div");s.className="token-detail-panel";const l=e.getBoundingClientRect();s.style.top=`${l.bottom+window.scrollY+8}px`,s.style.left=`${l.left+window.scrollX}px`;const d="string"==typeof t&&t.startsWith("{")&&t.endsWith("}"),c=d?t.substring(1,t.length-1):"",p=`--${n.split("/").slice(2).join("-").toLowerCase()}`,f=i||t,u=function(e,n){switch(e){case"color":return`color: var(${n});`;case"dimension":return`margin: var(${n});`;case"fontFamily":return`font-family: var(${n});`;case"fontWeight":return`font-weight: var(${n});`;case"fontSize":return`font-size: var(${n});`;case"lineHeight":return`line-height: var(${n});`;case"letterSpacing":return`letter-spacing: var(${n});`;case"shadow":return`box-shadow: var(${n});`;default:return`/* Custom property: */ var(${n});`}}(o,p),v=`${n.split("/").slice(2).join("-").toLowerCase()}`;let g="";g=d?`\n      <div class="reference-visualization">\n        <div class="reference-token-wrapper">\n          <div>${t}</div>\n        </div>\n        <div class="reference-arrow">⟶</div>\n        <div class="reference-target-wrapper">\n          <div>${i||"Not resolved"}</div>\n          ${i?`<div class="reference-preview" style="${"color"===o?`background-color: ${i};`:""}"></div>`:""}\n        </div>\n      </div>\n    `:function(e,n){switch(e){case"color":return`<div style="width: 100%; height: 30px; background-color: ${n}; border-radius: 4px;"></div>`;case"dimension":const e=String(n).replace(/[^0-9.]/g,"");return`<div style="width: 100%; height: 20px; background: #f0f0f0; border-radius: 4px; overflow: hidden;">\n                <div style="width: ${Math.min(parseFloat(e),100)}%; height: 100%; background: #0366d6;"></div>\n              </div>`;case"fontFamily":return`<div style="font-family: ${n}; font-size: 16px; text-align: center;">The quick brown fox jumps over the lazy dog</div>`;case"fontWeight":return`<div style="font-weight: ${n}; font-size: 16px; text-align: center;">The quick brown fox jumps over the lazy dog</div>`;case"fontSize":return`<div style="font-size: ${Math.min(parseFloat(n),24)+"px"}; text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">The quick brown fox jumps over the lazy dog</div>`;case"lineHeight":return`<div style="line-height: ${n}; font-size: 12px; text-align: center;">Line 1<br>Line 2</div>`;case"letterSpacing":return`<div style="letter-spacing: ${n}; font-size: 14px; text-align: center;">THE QUICK BROWN FOX</div>`;case"shadow":return`<div style="width: 60px; height: 30px; margin: 0 auto; background: white; border-radius: 4px; box-shadow: ${n};"></div>`;default:return`<div style="text-align: center; color: #666;">${n}</div>`}}(o,f);let h=`\n    <div class="token-detail-header">\n      <div class="token-detail-title">${function(e){const n=e.split("/");if(n.length<3)return e;const t=n[0],o=n[1],i=n[n.length-1],a=n.slice(2,-1).join("/");return`<strong>${i}</strong> <span style="color: #666; font-size: 10px;">(${t}/${o}${a?"/"+a:""})</span>`}(n)}</div>\n      <div class="token-detail-close">&times;</div>\n    </div>\n    \n    <div class="token-detail-content">\n      <div class="token-detail-row">\n        <div class="token-detail-label">Path:</div>\n        <div class="token-detail-value">${n}</div>\n      </div>\n      <div class="token-detail-row">\n        <div class="token-detail-label">Type:</div>\n        <div class="token-detail-value">${V(o)}</div>\n      </div>\n      <div class="token-detail-row">\n        <div class="token-detail-label">Value:</div>\n        <div class="token-detail-value">\n          ${t}\n          <button class="token-copy-button" data-copy-value="${t}">Copy</button>\n          ${d?'<span class="reference-label">Reference</span>':""}\n        </div>\n      </div>\n  `;d&&(h+=`\n      <div class="token-detail-row">\n        <div class="token-detail-label">References:</div>\n        <div class="token-detail-value">${c}</div>\n      </div>\n    `,i?(h+=`\n      <div class="token-detail-row">\n        <div class="token-detail-label">Resolved Value:</div>\n        <div class="token-detail-value">\n          ${i}\n          <button class="token-copy-button" data-copy-value="${i}">Copy</button>\n        </div>\n      </div>\n      `,r&&(h+=`\n        <div class="token-detail-row">\n          <div class="token-detail-label">Resolved From:</div>\n          <div class="token-detail-value">\n            ${r}\n          </div>\n        </div>\n        `),a&&(h+=`\n        <div class="token-detail-row">\n          <div class="token-detail-label">Ref Type:</div>\n          <div class="token-detail-value">\n            ${V(a)}\n          </div>\n        </div>\n        `)):h+='\n      <div class="token-detail-row">\n        <div class="token-detail-label">Resolved Value:</div>\n        <div class="token-detail-value">\n          <span style="color: #d32f2f;">Unresolved reference</span>\n        </div>\n      </div>\n      '),h+=`\n    </div>\n    \n    <div class="token-visualization">\n      ${g}\n    </div>\n  `,h+=`\n    <div class="token-usage-label">CSS Variable:</div>\n    <div class="token-detail-row">\n      <div class="token-detail-value">\n        ${p}\n        <button class="token-copy-button" data-copy-value="${p}">Copy</button>\n      </div>\n    </div>\n    \n    <div class="token-usage-label">CSS Usage:</div>\n    <div class="token-detail-row">\n      <div class="token-detail-value">\n        ${u}\n        <button class="token-copy-button" data-copy-value="${u}">Copy</button>\n      </div>\n    </div>\n    \n    <div class="token-usage-label">SCSS Variable:</div>\n    <div class="token-detail-row">\n      <div class="token-detail-value">\n        ${v}\n        <button class="token-copy-button" data-copy-value="${v}">Copy</button>\n      </div>\n    </div>\n  `,s.innerHTML=h,document.body.appendChild(s),s.querySelectorAll(".token-copy-button").forEach((e=>{e.addEventListener("click",(e=>{const n=e.currentTarget,t=n.dataset.copyValue||"";navigator.clipboard.writeText(t).then((()=>{n.textContent="Copied!",setTimeout((()=>{n.textContent="Copy"}),1e3)})),e.stopPropagation()}))}));const m=s.querySelector(".token-detail-close");m&&m.addEventListener("click",(()=>{s.remove()})),document.addEventListener("click",(function n(t){s.contains(t.target)||e.contains(t.target)||(s.remove(),document.removeEventListener("click",n))}))}(n,n.dataset.tokenPath||"",n.dataset.tokenValue||"",n.dataset.tokenType||"",n.dataset.referencedValue||"",n.dataset.referencedType||"",n.dataset.resolvedFrom||"")}))}(c)}function F(e){if("string"==typeof e){if(e.startsWith("{")&&e.endsWith("}"))return"reference";if(e.startsWith("#")||e.startsWith("rgb")||e.startsWith("hsl"))return"color";if(/^-?\d*\.?\d+(px|rem|em|%|vh|vw|vmin|vmax|pt|pc|in|cm|mm)$/.test(e))return"dimension";if(e.includes(",")&&(e.includes("sans-serif")||e.includes("serif")||e.includes("monospace")))return"fontFamily";if(/^(normal|bold|lighter|bolder|\d{3})$/.test(e))return"fontWeight";if(/^-?\d*\.?\d+(s|ms)$/.test(e))return"duration";if(e.includes("px")&&e.includes("rgba"))return"shadow"}else{if("number"==typeof e)return"number";if("boolean"==typeof e)return"boolean"}return"string"}function W(e,n){let t=`<div class="token-preview-subheading">${V(n)}</div>`;return t+='<div class="token-preview-items-grid">',e.forEach((e=>{const o="string"==typeof e.value&&e.value.startsWith("{")&&e.value.endsWith("}"),i=o&&void 0!==e.referencedValue?e.referencedValue:e.value,a=e.path.split("/").slice(2).join("/");let r="";switch(n){case"fontFamily":r=`<div class="font-family-sample" style="font-family: ${i}">Aa</div>`;break;case"fontWeight":r=`<div class="font-weight-sample" style="font-weight: ${i}">Aa</div>`;break;case"fontSize":const e=String(i),n=parseFloat(e),t=e.replace(/[0-9.]/g,"");r=`<div class="font-size-sample" style="font-size: ${n>32?`${Math.min(32,n)}${t}`:e}">Aa</div>`;break;case"lineHeight":r=`\n          <div class="line-height-sample">\n            <div style="line-height: ${i}">Line 1<br>Line 2<br>Line 3</div>\n          </div>\n        `;break;case"letterSpacing":r=`<div class="letter-spacing-sample" style="letter-spacing: ${i}">Spacing</div>`;break;default:r=`<div class="typography-sample">${i}</div>`}const s=e.resolvedFrom?`data-resolved-from="${e.resolvedFrom}"`:"";t+=`\n      <div class="token-preview-item typography-preview-item" \n           data-token-path="${e.path}" \n           data-token-value="${e.value}" \n           data-token-type="${e.type}"\n           ${e.referencedValue?`data-referenced-value="${e.referencedValue}"`:""}\n           ${e.referencedType?`data-referenced-type="${e.referencedType}"`:""}\n           ${s}>\n        ${r}\n        ${o?'<div class="reference-icon-small">↗</div>':""}\n        <div class="token-info">\n          <div class="token-path">${a}</div>\n          <div class="token-value">\n            ${e.value}\n            ${o?'<span class="reference-label">Reference</span>':""}\n            ${o&&e.referencedValue?`<span class="resolved-value">${e.referencedValue}</span>`:""}\n          </div>\n        </div>\n      </div>\n    `})),t+="</div>",t}function N(e,n){let t=`<div class="token-preview-subheading">${V(n)} Tokens</div>`;return t+='<div class="token-preview-items-grid">',e.forEach((e=>{const o="string"==typeof e.value&&e.value.startsWith("{")&&e.value.endsWith("}"),i=(o&&void 0!==e.referencedValue?e.referencedValue:e.value,e.path.split("/").slice(2).join("/")),a=e.resolvedFrom?`data-resolved-from="${e.resolvedFrom}"`:"";t+=`\n      <div class="token-preview-item generic-preview-item" \n           data-token-path="${e.path}" \n           data-token-value="${e.value}" \n           data-token-type="${e.type}"\n           ${e.referencedValue?`data-referenced-value="${e.referencedValue}"`:""}\n           ${e.referencedType?`data-referenced-type="${e.referencedType}"`:""}\n           ${a}>\n        <div class="generic-swatch">\n          <div class="generic-indicator">${n.charAt(0).toUpperCase()}</div>\n          ${o?'<div class="reference-icon-small">↗</div>':""}\n        </div>\n        <div class="token-info">\n          <div class="token-path">${i}</div>\n          <div class="token-value">\n            ${e.value}\n            ${o?'<span class="reference-label">Reference</span>':""}\n            ${o&&e.referencedValue?`<span class="resolved-value">${e.referencedValue}</span>`:""}\n          </div>\n        </div>\n      </div>\n    `})),t+="</div>",t}function V(e){return e.replace(/([A-Z])/g," $1").replace(/^./,(e=>e.toUpperCase())).trim()}function I(e,n){const t=z(e);let o="";return 0===t.unresolvedReferences.length?o='\n      <div class="reference-diagnosis">\n        <h3>Reference Analysis</h3>\n        <div class="diagnosis-success">\n          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM7 11.4L3.6 8L5 6.6L7 8.6L11 4.6L12.4 6L7 11.4Z" fill="#22863a"/>\n          </svg>\n          <span>All references were resolved successfully!</span>\n        </div>\n      </div>\n    ':(o=`\n      <div class="reference-diagnosis">\n        <h3>Reference Analysis</h3>\n        <div class="diagnosis-summary">\n          Found ${t.unresolvedReferences.length} unresolved references.\n          ${t.suggestedFixes.length>0?`${t.suggestedFixes.length} can be automatically fixed.`:""}\n        </div>\n        \n        <div class="unresolved-references">\n          <h4>Unresolved References</h4>\n          <table class="reference-table">\n            <thead>\n              <tr>\n                <th>Token Path</th>\n                <th>Reference</th>\n                <th>Potential Matches</th>\n              </tr>\n            </thead>\n            <tbody>\n    `,t.unresolvedReferences.forEach((e=>{let n="";n=e.potentialMatches.length>0?e.potentialMatches.map((e=>`<div class="potential-match" data-similarity="${Math.round(100*e.similarity)}%">\n                          <span class="match-path">${e.path}</span>\n                          <span class="match-similarity">${Math.round(100*e.similarity)}%</span>\n                        </div>`)).join(""):'<div class="no-matches">No potential matches found</div>',o+=`\n        <tr>\n          <td>${e.path}</td>\n          <td class="reference-value">{${e.reference}}</td>\n          <td>${n}</td>\n        </tr>\n      `})),o+="\n            </tbody>\n          </table>\n        </div>\n    ",t.suggestedFixes.length>0&&(o+='\n        <div class="suggested-fixes">\n          <h4>Suggested Fixes</h4>\n          <div class="fix-description">\n            These references can be automatically fixed by updating the paths.\n          </div>\n          <table class="reference-table">\n            <thead>\n              <tr>\n                <th>Token Path</th>\n                <th>Original</th>\n                <th>Suggested</th>\n                <th>Action</th>\n              </tr>\n            </thead>\n            <tbody>\n      ',t.suggestedFixes.forEach(((e,n)=>{o+=`\n          <tr>\n            <td>${e.path}</td>\n            <td class="reference-value">${e.original}</td>\n            <td class="reference-value suggested">${e.suggested}</td>\n            <td>\n              <button class="fix-button" data-fix-index="${n}">Apply</button>\n            </td>\n          </tr>\n        `})),o+='\n            </tbody>\n          </table>\n          <div class="fix-actions">\n            <button id="apply-all-fixes">Apply All Fixes</button>\n          </div>\n        </div>\n      '),o+='\n      <div class="reference-recommendations">\n        <h4>Recommendations</h4>\n        <ul>\n          <li>Review the token structure to ensure consistent naming patterns</li>\n          <li>Use explicit paths in references when possible</li>\n          <li>Consider organizing tokens in a flat structure for easier reference resolution</li>\n          <li>For Style Dictionary compatibility, ensure references use the same format</li>\n        </ul>\n      </div>\n    ',o+="</div>"),n.innerHTML=o,t}function O(e,n,t){const o=z(n),i=e.querySelector("#apply-all-fixes");i&&i.addEventListener("click",(()=>{const e=function(e,n){let t=JSON.parse(JSON.stringify(e));for(const e of n)t=P(t,e);return t}(n,o.suggestedFixes);t(e)})),e.querySelectorAll(".fix-button").forEach((e=>{e.addEventListener("click",(e=>{const i=parseInt(e.currentTarget.dataset.fixIndex||"0"),a=P(n,o.suggestedFixes[i]);t(a)}))}))}function P(e,n){const t=JSON.parse(JSON.stringify(e)),o=n.path.split(".");let i=t;for(let e=0;e<o.length;e++){const a=o[e];if(void 0===i[a])return console.warn(`Path ${n.path} not found in token data`),t;e===o.length-1?i[a].$value===n.original&&(i[a].$value=n.suggested):i=i[a]}return t}E.styleTagTransform=v(),E.setAttributes=c(),E.insert=l().bind(null,"head"),E.domAPI=r(),E.insertStyleElement=f(),i()($.A,E),$.A&&$.A.locals&&$.A.locals;let q,B=null,U=null,H=[],D=new Map,J=null,X=!0,Y=[],Z={resolved:0,unresolved:0};const G=document.getElementById("output"),K=document.getElementById("status"),_=document.getElementById("download-btn"),Q=document.getElementById("extract-btn"),ee=document.getElementById("validate-btn"),ne=document.getElementById("collection-modes-list"),te=document.getElementById("toggle-all-collections"),oe=document.getElementById("validate-references"),ie=document.getElementById("flat-structure"),ae=document.getElementById("separate-files"),re=document.getElementById("format-dtcg"),se=document.getElementById("format-legacy"),le=document.getElementById("reference-validation-results"),de=document.getElementById("validation-content"),ce=document.getElementById("preview-tabs"),pe=document.querySelector(".preview-content"),fe=document.getElementById("visual-preview-container"),ue=document.createElement("style");function ve(e){if("combined"===e){const e=[];return D.forEach(((n,t)=>{n.forEach((n=>{e.push(n)}))})),S(B,H,e,ie.checked)}const[n,t]=e.split("-");return n&&t&&B[n]&&B[n][t]?{[n]:{[t]:B[n][t]}}:{}}function ge(){var e;if(!B)return;const n=[];D.forEach(((e,t)=>{e.forEach((e=>{n.push(e)}))}));const t=S(B,H,n,ie.checked);G.textContent=C(t);const o=e=>{const n=fe.querySelector(".token-preview-wrapper");n&&n.remove(),M(e,fe,0,((e,n)=>{Z={resolved:e,unresolved:n},n>0?(K.textContent=`Found ${e} resolved and ${n} unresolved references. Click "Reference Diagnoser" for details.`,K.className="warning"):e>0&&(K.textContent=`All ${e} references resolved successfully.`,K.className="success")}))};!function(e,n,t,o,i,a,r,s){var l;a.querySelectorAll('.tab-button:not([data-tab="combined"])').forEach((e=>e.remove())),r.querySelectorAll(".tab-content:not(#tab-combined)").forEach((e=>e.remove()));const d=function(e,n,t,o){const i=[];for(const a of n)if(e[a]){const n=t.get(a)||[];for(const t of n)if(e[a][t]){const n=o?A(`${a}.${t}`,e[a][t]):{[a]:{[t]:e[a][t]}};i.push({id:`${a}-${t}`,name:`${a}/${t}`,data:n})}}return i}(e,n,t,o);d.forEach((e=>{const n=document.createElement("button");n.className="tab-button",n.dataset.tab=e.id,n.textContent=e.name,n.addEventListener("click",(n=>{n.preventDefault(),L(e.id,a,r,e.data,s),s&&s(e.data)})),a.appendChild(n);const t=document.createElement("div");t.className="tab-content",t.id=`tab-${e.id}`,t.style.display="none";const o=document.createElement("pre");o.textContent=C(e.data),t.appendChild(o),r.appendChild(t)}));const c=a.querySelector('.tab-button[data-tab="combined"]');if(c){const o=c.cloneNode(!0);null===(l=c.parentNode)||void 0===l||l.replaceChild(o,c),o.addEventListener("click",(o=>{o.preventDefault();const i={};for(const o of n)if(e[o]){i[o]={};const n=t.get(o)||[];for(const t of n)e[o][t]&&(i[o][t]=e[o][t])}L("combined",a,r,i,s)}))}const p={};for(const o of n)if(e[o]){p[o]={};const n=t.get(o)||[];for(const t of n)e[o][t]&&(p[o][t]=e[o][t])}L("combined",a,r,p,s)}(B,H,D,ie.checked,ae.checked,ce,pe,o);const i=(null===(e=document.querySelector(".tab-button.active"))||void 0===e?void 0:e.getAttribute("data-tab"))||"combined";o("combined"===i?t:ve(i)),_.disabled=0===Object.keys(t).length,oe.checked&&(Y=function(e){const n=[],t=new Map;function o(e,n=""){if(e&&"object"==typeof e&&!Array.isArray(e))if(void 0===e.$value)for(const i in e){const a=n?`${n}/${i}`:i,r=e[i];"object"==typeof r&&null!==r?o(r,a):t.set(a,r)}else t.set(n,e.$value)}function i(e,o=""){if(e&&"object"==typeof e&&!Array.isArray(e)){if(e.$value&&"string"==typeof e.$value&&e.$value.startsWith("{")&&e.$value.endsWith("}")){const i=e.$value.substring(1,e.$value.length-1);let a=!1;for(const[e,n]of t.entries())if(e===i||e.endsWith(`/${i}`)){a=!0;break}a||n.push({path:o,reference:i,message:`Reference '${i}' not found in tokens`})}for(const a in e){const r=o?`${o}/${a}`:a,s=e[a];if("object"==typeof s&&null!==s)i(s,r);else if("string"==typeof s&&s.startsWith("{")&&s.endsWith("}")){const e=s.substring(1,s.length-1);let o=!1;for(const[n,i]of t.entries())if(n===e||n.endsWith(`/${e}`)){o=!0;break}o||n.push({path:r,reference:e,message:`Reference '${e}' not found in tokens`})}}}}for(const n in e)for(const t in e[n])o(e[n][t],`${n}/${t}`);for(const n in e)for(const t in e[n])i(e[n][t],`${n}/${t}`);return n}(t),Y.length>0?(K.textContent=`Found ${Y.length} reference problems. Click "Validate References" for details.`,K.className="warning"):(K.textContent="All references are valid.",K.className="success"))}ue.textContent="\n    .reference-diagnosis {\n      margin-top: 20px;\n      padding: 12px;\n      border-radius: 4px;\n      border: 1px solid #e0e0e0;\n      background-color: #f9f9f9;\n    }\n    \n    .reference-diagnosis h3 {\n      margin-top: 0;\n      margin-bottom: 12px;\n      font-size: 14px;\n      font-weight: 600;\n    }\n    \n    .reference-diagnosis h4 {\n      margin-top: 16px;\n      margin-bottom: 8px;\n      font-size: 13px;\n      font-weight: 500;\n    }\n    \n    .diagnosis-success {\n      display: flex;\n      align-items: center;\n      padding: 8px 12px;\n      background-color: #e6ffed;\n      border-radius: 4px;\n      color: #22863a;\n      font-weight: 500;\n    }\n    \n    .diagnosis-success svg {\n      margin-right: 8px;\n    }\n    \n    .diagnosis-summary {\n      padding: 8px 12px;\n      background-color: #fff8e1;\n      border-radius: 4px;\n      color: #b08800;\n      margin-bottom: 12px;\n    }\n    \n    .reference-table {\n      width: 100%;\n      border-collapse: collapse;\n      font-size: 11px;\n      margin-bottom: 16px;\n    }\n    \n    .reference-table th {\n      text-align: left;\n      padding: 6px 8px;\n      background-color: #f0f0f0;\n      border: 1px solid #e0e0e0;\n    }\n    \n    .reference-table td {\n      padding: 6px 8px;\n      border: 1px solid #e0e0e0;\n      vertical-align: top;\n    }\n    \n    .reference-value {\n      font-family: monospace;\n      color: #0366d6;\n    }\n    \n    .reference-value.suggested {\n      color: #22863a;\n      font-weight: 500;\n    }\n    \n    .potential-match {\n      display: flex;\n      justify-content: space-between;\n      padding: 4px 0;\n      border-bottom: 1px solid #f0f0f0;\n    }\n    \n    .potential-match:last-child {\n      border-bottom: none;\n    }\n    \n    .match-path {\n      font-family: monospace;\n    }\n    \n    .match-similarity {\n      margin-left: 8px;\n      color: #666;\n      font-size: 10px;\n    }\n    \n    .no-matches {\n      color: #d73a49;\n      font-style: italic;\n    }\n    \n    .fix-button {\n      background-color: #0366d6;\n      color: white;\n      padding: 3px 8px;\n      border: none;\n      border-radius: 3px;\n      cursor: pointer;\n      font-size: 10px;\n      margin: 0;\n    }\n    \n    .fix-button:hover {\n      background-color: #0056b3;\n    }\n    \n    .fix-actions {\n      margin-top: 12px;\n      text-align: right;\n    }\n    \n    .fix-description {\n      margin-bottom: 8px;\n      color: #666;\n      font-size: 11px;\n    }\n    \n    .reference-recommendations {\n      background-color: #f0f7ff;\n      padding: 8px 12px;\n      border-radius: 4px;\n      margin-top: 16px;\n    }\n    \n    .reference-recommendations ul {\n      margin: 8px 0 0 0;\n      padding-left: 20px;\n    }\n    \n    .reference-recommendations li {\n      margin-bottom: 4px;\n      font-size: 11px;\n    }\n  ",document.head.appendChild(ue),document.addEventListener("DOMContentLoaded",(()=>{var e;console.log("UI loaded and initialized"),K.textContent="Extracting tokens...",K.className="info",function(){const e=document.getElementById("color-hex"),n=document.getElementById("color-rgb"),t=document.getElementById("color-rgba"),o=document.getElementById("color-hsl"),i=document.getElementById("color-hsla");let a="hex";function r(e){console.log(`Sending color format to plugin: ${e}`),parent.postMessage({pluginMessage:{type:"apply-color-format",colorFormat:e}},"*")}e.addEventListener("change",(()=>{e.checked&&"hex"!==a&&(a="hex",r(a))})),n.addEventListener("change",(()=>{n.checked&&"rgb"!==a&&(a="rgb",r(a))})),t.addEventListener("change",(()=>{t.checked&&"rgba"!==a&&(a="rgba",r(a))})),o.addEventListener("change",(()=>{o.checked&&"hsl"!==a&&(a="hsl",r(a))})),i.addEventListener("change",(()=>{i.checked&&"hsla"!==a&&(a="hsla",r(a))})),a="hex",e.checked=!0}(),q=function(){const e=document.querySelector('.segmented-toggle-option[data-mode="json"]'),n=document.querySelector('.segmented-toggle-option[data-mode="visual"]'),t=document.querySelector(".preview-content-json"),o=document.querySelector(".preview-content-visual");let i="json";return e.addEventListener("click",(()=>{"json"!==i&&(e.classList.add("active"),n.classList.remove("active"),t.classList.add("active"),o.classList.remove("active"),i="json")})),n.addEventListener("click",(()=>{"visual"!==i&&(n.classList.add("active"),e.classList.remove("active"),o.classList.add("active"),t.classList.remove("active"),i="visual")})),{setMode:t=>{"json"===t?e.click():n.click()},getCurrentMode:()=>i}}(),function(){if(!ce.querySelector('.tab-button[data-tab="combined"]')){const e=document.createElement("button");e.className="tab-button active",e.dataset.tab="combined",e.textContent="Combined",e.addEventListener("click",(e=>{if(e.preventDefault(),L("combined",ce,pe),"visual"===q.getCurrentMode()){const e=ve("combined"),n=fe.querySelector(".token-preview-wrapper");n&&n.remove(),M(e,fe)}})),ce.appendChild(e)}if(!document.getElementById("tab-combined")){const e=document.createElement("div");if(e.className="tab-content",e.id="tab-combined",e.style.display="block",G.parentNode){const n=G.cloneNode(!0);e.appendChild(n)}else e.appendChild(G);pe.appendChild(e)}}(),re.addEventListener("change",ge),se.addEventListener("change",ge),oe.addEventListener("change",ge),ie.addEventListener("change",ge),ae.addEventListener("change",ge),te.addEventListener("click",(()=>{const e=function(e,n,t){const o=n.querySelectorAll("input[data-collection]:not([data-mode])"),i=n.querySelectorAll("input[data-mode]");for(let n=0;n<o.length;n++)o[n].checked=e;for(let n=0;n<i.length;n++)i[n].checked=e;const a=[],r=new Map,s=Object.keys(t);return e?s.forEach((e=>{a.push(e);const n=Object.keys(t[e]);r.set(e,[...n])})):s.forEach((e=>{r.set(e,[])})),{selectedCollections:a,selectedModes:r,allCollections:s}}(!X,ne,B);H=e.selectedCollections,D=e.selectedModes,J=e.allCollections,X=!X,te.textContent=X?"Deselect All":"Select All",ge()})),ee.addEventListener("click",(()=>{var e;if(function(e,n,t){if(0===e.length)n.innerHTML='<div class="success">All references are valid! Your tokens are ready to use with Style Dictionary.</div>';else{let t=`<div class="warning">Found ${e.length} reference problems:</div><ul>`;for(const n of e)t+=`<li class="reference-problem">\n                  Token at <strong>${n.path}</strong> \n                  references <strong>${n.reference}</strong> which cannot be resolved\n                 </li>`;t+="</ul>",t+='<div class="validation-tools">\n                <p>Recommendations:</p>\n                <ul>\n                  <li>Try using the "Flat Structure" option for easier reference resolution</li>\n                  <li>Check that all referenced tokens exist in the exported collections/modes</li>\n                  <li>Consider simplifying your token structure for better compatibility</li>\n                </ul>\n              </div>',n.innerHTML=t}t.style.display="block"}(Y,de,le),B){const n=(null===(e=document.querySelector(".tab-button.active"))||void 0===e?void 0:e.getAttribute("data-tab"))||"combined",t="combined"===n?S(B,H,Array.from(D.values()).flat(),ie.checked):ve(n),o=document.createElement("div");o.id="reference-diagnosis-container",de.appendChild(o),I(t,o),O(o,t,(e=>{var t;if("combined"===n)B=e;else{const[o,i]=n.split("-");o&&i&&(null===(t=e[o])||void 0===t?void 0:t[i])&&(B[o][i]=e[o][i])}ge(),K.textContent="References fixed successfully!",K.className="success",I(S(B,H,Array.from(D.values()).flat(),ie.checked),o)}))}})),Q.addEventListener("click",(()=>{le.style.display="none",G.textContent="Loading data...",K.textContent="Extracting tokens...",K.className="info",ne.innerHTML='\n      <div class="loading">\n        <div class="spinner"></div>\n        Loading collections and modes...\n      </div>\n    ',_.disabled=!0,parent.postMessage({pluginMessage:{type:"extract-tokens"}},"*")})),_.addEventListener("click",(()=>{const e=[];if(D.forEach(((n,t)=>{n.forEach((n=>{e.push(n)}))})),ae.checked){const n=function(e,n,t,o){const i=S(e,n,t,o),a=[];if(o){const e=new Set;for(const n in i){const t=n.split(".");t.length>=2&&e.add(`${t[0]}.${t[1]}`)}for(const n of e){const[e,t]=n.split("."),o={};for(const e in i)e.startsWith(n)&&(o[e.substring(n.length+1)]=i[e]);Object.keys(o).length>0&&a.push({name:`${e}-${t}.json`,data:o})}}else for(const e in i)for(const n in i[e])a.push({name:`${e}-${n}.json`,data:{[e]:{[n]:i[e][n]}}});return a.push({name:"design-tokens-all.json",data:i}),a}(B,H,e,ie.checked);!function(e,n,t){if(1===e.length)return void j(e[0].data,e[0].name);const o=document.createElement("div");o.style.display="none",document.body.appendChild(o);let i="<p>Multiple files are ready for download:</p><ul>";e.forEach(((e,n)=>{const t=JSON.stringify(e.data,null,2),a=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download=e.name,s.textContent=`Download ${e.name}`,s.id=`download-link-${n}`,s.className="download-link",o.appendChild(s),i+=`<li><a href="#" onclick="document.getElementById('download-link-${n}').click(); return false;">${e.name}</a></li>`})),i+="</ul>",n.innerHTML=i,t.style.display="block";const a=o.querySelector(".download-link");a&&a.click()}(n,de,le),K.textContent="Files ready for download. Click the links above to download each file.",K.className="success"}else j(S(B,H,e,ie.checked),`design-tokens-${re.checked?"dtcg":"legacy"}-${(new Date).toISOString().split("T")[0]}.json`),K.textContent="Tokens downloaded successfully!",K.className="success"}));const n=document.createElement("button");n.id="diagnose-references-btn",n.textContent="Reference Diagnoser",n.addEventListener("click",(()=>{var e;le.style.display="block",de.innerHTML="<h3>Reference Diagnosis</h3>";const n=document.createElement("div");n.id="reference-diagnosis-container",de.appendChild(n);const t=(null===(e=document.querySelector(".tab-button.active"))||void 0===e?void 0:e.getAttribute("data-tab"))||"combined",o="combined"===t?S(B,H,Array.from(D.values()).flat(),ie.checked):ve(t);I(o,n),O(n,o,(e=>{var o;if("combined"===t)B=e;else{const[n,i]=t.split("-");n&&i&&(null===(o=e[n])||void 0===o?void 0:o[i])&&(B[n][i]=e[n][i])}ge(),K.textContent="References fixed successfully!",K.className="success",I(S(B,H,Array.from(D.values()).flat(),ie.checked),n)}))})),null===(e=ee.parentNode)||void 0===e||e.insertBefore(n,ee.nextSibling)})),window.onmessage=e=>{if(console.log("UI received message:",e.data),e.data.pluginMessage){const n=e.data.pluginMessage;if("tokens-data"===n.type){console.log("UI received tokens data"),U=JSON.parse(JSON.stringify(n.data)),B=n.data;const e=function(e,n,t){if(!e)return{selectedCollections:[],selectedModes:new Map,allCollections:[]};n.innerHTML="";const o=Object.keys(e);if(0===o.length)return n.innerHTML="<div>No collections found</div>",{selectedCollections:[],selectedModes:new Map,allCollections:[]};const i=[...o],a=new Map,r=[...o];return o.forEach((o=>{const r=document.createElement("div");r.className="collection-item",r.dataset.collection=o;const s=Object.keys(e[o]);a.set(o,[...s]);const l=document.createElement("div");l.className="collection-header";const d=document.createElement("input");d.type="checkbox",d.id=`collection-${o}`,d.checked=!0,d.dataset.collection=o;const c=document.createElement("span");c.className="collection-toggle expander-icon expanded",c.dataset.collection=o;const p=document.createElement("label");p.htmlFor=`collection-${o}`,p.textContent=o;const f=document.createElement("span");f.className="collection-badge",f.textContent=`${s.length} modes`,l.appendChild(c),l.appendChild(d),l.appendChild(p),l.appendChild(f);const u=document.createElement("div");u.className="mode-container",u.dataset.collection=o,s.forEach((n=>{const r=document.createElement("div");r.className="mode-item";const s=document.createElement("input");s.type="checkbox",s.id=`mode-${o}-${n}`,s.checked=!0,s.dataset.collection=o,s.dataset.mode=n;const l=document.createElement("label");l.htmlFor=`mode-${o}-${n}`;const c=function(e){let n=0;return function e(t){if(t&&"object"==typeof t)if(void 0===t.$value||void 0===t.$type)for(const o in t)"object"==typeof t[o]&&null!==t[o]?e(t[o]):"$type"!==o&&"$description"!==o&&n++;else n++}(e),n}(e[o][n]);l.textContent=`${n}`;const p=document.createElement("span");p.className="token-count",p.textContent=`(${c} tokens)`,l.appendChild(p),r.appendChild(s),r.appendChild(l),u.appendChild(r),s.addEventListener("change",(()=>{const e=a.get(o)||[];if(s.checked)e.includes(n)||(e.push(n),a.set(o,e));else{const t=e.filter((e=>e!==n));if(a.set(o,t),0===t.length){d.checked=!1;const e=i.indexOf(o);e>-1&&i.splice(e,1)}}t()}))})),d.addEventListener("change",(()=>{const e=u.querySelectorAll('input[type="checkbox"]');if(d.checked){i.includes(o)||i.push(o);for(let n=0;n<e.length;n++){const t=e[n];t.checked=!0;const i=t.dataset.mode;if(i){const e=a.get(o)||[];e.includes(i)||(e.push(i),a.set(o,e))}}}else{const n=i.indexOf(o);n>-1&&i.splice(n,1);for(let n=0;n<e.length;n++)e[n].checked=!1;a.set(o,[])}t()})),c.addEventListener("click",(()=>{c.classList.contains("expanded")?(c.classList.remove("expanded"),u.style.display="none"):(c.classList.add("expanded"),u.style.display="block")})),r.appendChild(l),r.appendChild(u),n.appendChild(r)})),{selectedCollections:i,selectedModes:a,allCollections:r}}(B,ne,ge);H=e.selectedCollections,D=e.selectedModes,J=e.allCollections,X=!0,te.textContent=X?"Deselect All":"Select All",ge(),K.textContent="Tokens extracted successfully!",K.className="success"}else"error"===n.type&&(console.error("UI received error:",n.message),G.textContent="Error: "+n.message,K.textContent=n.message,K.className="error")}},console.log("UI sending ready message to plugin"),parent.postMessage({pluginMessage:{type:"ui-ready"}},"*")})();</script></body></html>