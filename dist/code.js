(()=>{"use strict";({383:function(){var e=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(r,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(i,a)}c((n=n.apply(e,o||[])).next())}))};function o(){return e(this,void 0,void 0,(function*(){try{console.log("Starting complete variable extraction");const e=yield figma.variables.getLocalVariableCollections();console.log("Collections found:",e.length);const o={};for(const t of e){const e=t.name.toLowerCase();console.log("Processing collection:",e),o[e]={};const n=figma.variables.getLocalVariables().filter((e=>e.variableCollectionId===t.id));console.log(`Found ${n.length} variables in collection ${e}`);for(const r of t.modes){const t=r.name;console.log(`Processing mode: ${t}`),o[e][t]={};for(const s of n){const n=s.valuesByMode[r.modeId];if(void 0===n)continue;const i=s.name.split("/").filter((e=>e.trim().length>0)),a=i.length>0?i:["base"];let c=null;if("COLOR"===s.resolvedType)try{const e=n;if(e&&"number"==typeof e.r){const o=Math.round(255*e.r),t=Math.round(255*e.g),n=Math.round(255*e.b);c=`#${o.toString(16).padStart(2,"0")}${t.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}`,1!==e.a&&(c+=Math.round(255*e.a).toString(16).padStart(2,"0"))}else c=String(n)}catch(e){c=String(n)}else c="object"==typeof n&&null!==n?JSON.stringify(n):n;let l=o[e][t];for(let e=0;e<a.length-1;e++){const o=a[e];l[o]||(l[o]={}),l=l[o]}l[a[a.length-1]]=c}}}return console.log("Complete extraction finished"),o}catch(e){throw console.error("Error in extractVariables:",e),e}}))}figma.showUI(__html__,{width:600,height:600}),console.log("Plugin UI shown");let t=!0;figma.ui.onmessage=n=>e(void 0,void 0,void 0,(function*(){if(console.log("Plugin received message from UI:",n.type),"ui-ready"===n.type){if(console.log("UI is ready, sending data"),t){t=!1;try{const e=yield o();console.log("Extracted complete tokens, sending to UI"),figma.ui.postMessage({type:"tokens-data",data:e})}catch(e){console.error("Error extracting tokens:",e),figma.ui.postMessage({type:"error",message:`Error extracting tokens: ${e instanceof Error?e.message:"Unknown error"}`})}}}else if("extract-tokens"===n.type)try{const e=yield o();console.log("Extracted tokens on demand, sending to UI"),figma.ui.postMessage({type:"tokens-data",data:e})}catch(e){console.error("Error extracting tokens:",e),figma.ui.postMessage({type:"error",message:`Error extracting tokens: ${e instanceof Error?e.message:"Unknown error"}`})}else"close"===n.type&&figma.closePlugin()}))}})[383]()})();